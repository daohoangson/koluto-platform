var util = require('util');
var _ = require('underscore')._;

var Tokenizer = function(options) {
    var options = options || {};
    
    // exception:
    // - not included to support some odd type of words
    this._pattern = new RegExp(/[~`!@#$%\^&\*\(\)_=\+\[{\]}\\\|;:'",<.>\/\? …“” •–≤’®©]/);
    
    this._numberPattern = new RegExp(/[0-9]/);
    this._nonNumberPattern = new RegExp(/[^0-9]/);
    this._fullNumberPattern = new RegExp(/[\+\-0-9,.]+/);
};

Tokenizer.prototype.tokenize = function(text) {
    var results = text.split(this._pattern);
    var thisTokenize = this;

    results = _.filter(results, function(result) {
        if (thisTokenize.isMixedNumberAndNonNumber(result)) {
            // we don't take token that mixes
            return false;
        }
        
        return true;
    });

    return _.without(results, '', ' ');
};

Tokenizer.prototype.isMixedNumberAndNonNumber = function(text) {
    var hasNumber = text.match(this._numberPattern) != null;
    var hasNonNumber = text.match(this._nonNumberPattern) != null;

    return (hasNumber && hasNonNumber);
}

module.exports = Tokenizer;